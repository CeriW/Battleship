/*! For license information please see 789.ad098b6a.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkbattleship2=self.webpackChunkbattleship2||[]).push([[789],{"./src/GameContext.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>GameContext,S:()=>GameProvider});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_logic_placeShips__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/logic/placeShips.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js");const calculateAdjacentShipModifier=aiLevel=>{switch(aiLevel){case"hard":default:return 0;case"medium":return.7;case"easy":return 1}},GameContext=(0,react__WEBPACK_IMPORTED_MODULE_0__.createContext)({}),GameProvider=_ref=>{let{children}=_ref;const[userShips,setUserShips]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)((0,_logic_placeShips__WEBPACK_IMPORTED_MODULE_1__.V9)()),[computerShips,setComputerShips]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)((0,_logic_placeShips__WEBPACK_IMPORTED_MODULE_1__.V9)()),[playerTurn,setPlayerTurn]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(Math.random()>.5?"user":"computer"),[log,setLog]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)([]),[gameEnded,setGameEnded]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),[aiLevel,setAiLevel]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)("hard"),[aiAdjacentShipModifier,setAiAdjacentShipModifier]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(calculateAdjacentShipModifier(aiLevel)),debounceTimerRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null),previousAiLevelRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(aiLevel);(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{setAiAdjacentShipModifier(calculateAdjacentShipModifier(aiLevel))}),[aiLevel]);const addToLog=message=>{console.log(message),setLog((prevLog=>[`${message} - ${(new Date).toISOString()}`,...prevLog]))};return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>()=>{debounceTimerRef.current&&clearTimeout(debounceTimerRef.current)}),[]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(GameContext.Provider,{value:{userShips,setUserShips,computerShips,setComputerShips,playerTurn,setPlayerTurn,log,addToLog,gameEnded,setGameEnded,aiLevel,setAiLevel:level=>{setAiLevel(level),debounceTimerRef.current&&clearTimeout(debounceTimerRef.current),debounceTimerRef.current=setTimeout((()=>{previousAiLevelRef.current!==level&&(addToLog(`AI level changed to ${level}`),previousAiLevelRef.current=level)}),500)},aiAdjacentShipModifier,setAiAdjacentShipModifier},children})};GameProvider.__docgenInfo={description:"",methods:[],displayName:"GameProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}}},"./src/components/Board.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/react/index.js");var _types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/types.ts"),_Icons__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/components/Icons.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/jsx-runtime.js");const Board=_ref=>{let{positions}=_ref;const columnMarkers=[];for(let i=0;i<=10;i++)columnMarkers.push((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:"column-marker","data-testid":"column-marker",children:0===i?"":i},`column-marker-${i}`));const letters=["A","B","C","D","E","F","G","H","I","J"],rows=[];for(let y=0;y<letters.length;y++){const cells=[];for(let x=0;x<10;x++){var _positions$y$x$name,_positions$y$x,_positions$y$x$status,_positions$y$x2,_positions$y$x3,_positions$y$x4;cells.push((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("div",{className:`cell ${null!==(_positions$y$x$name=null===(_positions$y$x=positions[y][x])||void 0===_positions$y$x?void 0:_positions$y$x.name)&&void 0!==_positions$y$x$name?_positions$y$x$name:""} ${null!==(_positions$y$x$status=null===(_positions$y$x2=positions[y][x])||void 0===_positions$y$x2?void 0:_positions$y$x2.status)&&void 0!==_positions$y$x$status?_positions$y$x$status:""}`,"data-testid":"cell",children:[(null===(_positions$y$x3=positions[y][x])||void 0===_positions$y$x3?void 0:_positions$y$x3.status)===_types__WEBPACK_IMPORTED_MODULE_1__.J.hit&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_Icons__WEBPACK_IMPORTED_MODULE_2__.l,{}),(null===(_positions$y$x4=positions[y][x])||void 0===_positions$y$x4?void 0:_positions$y$x4.status)===_types__WEBPACK_IMPORTED_MODULE_1__.J.miss&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_Icons__WEBPACK_IMPORTED_MODULE_2__.i,{})]},`cell-${letters[y]}-${x}`))}rows.push((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("div",{className:"row",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:"row-marker","data-testid":"row-marker",children:letters[y]},`row-marker-${y}`),cells]},`row-${y}`))}return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("div",{className:"board","data-testid":"board",children:[columnMarkers,rows]})},__WEBPACK_DEFAULT_EXPORT__=Board;Board.__docgenInfo={description:"",methods:[],displayName:"Board",props:{positions:{required:!0,tsType:{name:"Array",elements:[{name:"Array",elements:[{name:"unknown"}],raw:"({ name: ShipNames | null; status: CellStates } | null)[]"}],raw:"({ name: ShipNames | null; status: CellStates } | null)[][]"},description:""}}}},"./src/components/Icons.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{i:()=>MissIcon,l:()=>HitIcon});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js");const MissIcon=()=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 -960 960 960",width:"90%",height:"90%",fill:"#000",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("path",{d:"m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"})}),HitIcon=()=>{const versionRef=react__WEBPACK_IMPORTED_MODULE_0__.useRef(Math.ceil(9*Math.random()));return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("img",{src:`/img/fire-${versionRef.current}.svg`,alt:"Hit marker",width:"90%",height:"90%"})};MissIcon.__docgenInfo={description:"",methods:[],displayName:"MissIcon"},HitIcon.__docgenInfo={description:"",methods:[],displayName:"HitIcon"}},"./src/components/UserGuessBoard.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/types.ts"),_GameContext__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/GameContext.tsx"),_logic_helpers__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/logic/helpers.ts"),_Icons__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/components/Icons.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/react/jsx-runtime.js");const UserGuessBoard=()=>{const{computerShips,setComputerShips,playerTurn,setPlayerTurn,addToLog,gameEnded,setGameEnded}=react__WEBPACK_IMPORTED_MODULE_0__.useContext(_GameContext__WEBPACK_IMPORTED_MODULE_2__.A),columnMarkers=[];for(let i=0;i<=10;i++)columnMarkers.push((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("div",{className:"column-marker","data-testid":"column-marker",children:0===i?"":i},`column-marker-${i}`));const letters=["A","B","C","D","E","F","G","H","I","J"],rows=[];for(let y=0;y<letters.length;y++){const cells=[];for(let x=0;x<10;x++){var _computerShips$y$x,_computerShips$y$x2,_computerShips$y$x3,_computerShips$y$x4,_computerShips$y$x5,_computerShips$y$x6;const shipIsSunk=(0,_logic_helpers__WEBPACK_IMPORTED_MODULE_3__.Q7)(null===(_computerShips$y$x=computerShips[y][x])||void 0===_computerShips$y$x?void 0:_computerShips$y$x.name,computerShips);cells.push((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)("div",{className:`cell ${(null===(_computerShips$y$x2=computerShips[y][x])||void 0===_computerShips$y$x2?void 0:_computerShips$y$x2.status)||"unguessed"}`,"data-testid":"cell",onClick:()=>{if(gameEnded)return;const cell=computerShips[y][x];if(cell&&(cell.status===_types__WEBPACK_IMPORTED_MODULE_1__.J.hit||cell.status===_types__WEBPACK_IMPORTED_MODULE_1__.J.miss)||"computer"===playerTurn)return;const newComputerShips=[...computerShips];if(cell&&cell.name){newComputerShips[y][x]={...cell,status:_types__WEBPACK_IMPORTED_MODULE_1__.J.hit};const shipIsSunk=(0,_logic_helpers__WEBPACK_IMPORTED_MODULE_3__.Q7)(cell.name,newComputerShips);newComputerShips[y][x]={...cell,status:_types__WEBPACK_IMPORTED_MODULE_1__.J.hit},addToLog(`User guessed ${letters[y]}${x+1}, hit`),shipIsSunk&&(addToLog(`User sunk ${null==cell?void 0:cell.name}`),setComputerShips(newComputerShips),(0,_logic_helpers__WEBPACK_IMPORTED_MODULE_3__.U4)(newComputerShips)&&(addToLog("user wins"),(0,_logic_helpers__WEBPACK_IMPORTED_MODULE_3__.oE)("user"),setGameEnded(!0)))}else newComputerShips[y][x]={name:null,status:_types__WEBPACK_IMPORTED_MODULE_1__.J.miss},setComputerShips(newComputerShips),addToLog(`User guessed ${letters[y]}${x+1}, miss`);setPlayerTurn("computer")},children:[(null===(_computerShips$y$x3=computerShips[y][x])||void 0===_computerShips$y$x3?void 0:_computerShips$y$x3.status)===_types__WEBPACK_IMPORTED_MODULE_1__.J.hit&&shipIsSunk&&"ðŸ’€",(null===(_computerShips$y$x4=computerShips[y][x])||void 0===_computerShips$y$x4?void 0:_computerShips$y$x4.status)===_types__WEBPACK_IMPORTED_MODULE_1__.J.hit&&!shipIsSunk&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_Icons__WEBPACK_IMPORTED_MODULE_4__.l,{}),(null===(_computerShips$y$x5=computerShips[y][x])||void 0===_computerShips$y$x5?void 0:_computerShips$y$x5.status)===_types__WEBPACK_IMPORTED_MODULE_1__.J.miss&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_Icons__WEBPACK_IMPORTED_MODULE_4__.i,{}),(null===(_computerShips$y$x6=computerShips[y][x])||void 0===_computerShips$y$x6?void 0:_computerShips$y$x6.status)===_types__WEBPACK_IMPORTED_MODULE_1__.J.unguessed&&""]},`cell-${letters[y]}-${x}`))}rows.push((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)("div",{className:"row",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("div",{className:"row-marker","data-testid":"row-marker",children:letters[y]},`row-marker-${y}`),cells]},`row-${y}`))}return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)("div",{className:"board user-guess-board","data-testid":"user-guess-board",children:[columnMarkers,rows]})},__WEBPACK_DEFAULT_EXPORT__=UserGuessBoard;UserGuessBoard.__docgenInfo={description:"",methods:[],displayName:"UserGuessBoard"}},"./src/logic/helpers.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{PZ:()=>doesShipFit,Pm:()=>generatePotentialCoordinates,Q7:()=>isShipSunk,U4:()=>checkAllShipsSunk,oE:()=>declareWinner});var _types__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/types.ts");const doesShipFit=(proposedCoordinates,shipSize)=>!("horizontal"===proposedCoordinates.alignment&&proposedCoordinates.startingColumn+shipSize>10)&&!("vertical"===proposedCoordinates.alignment&&proposedCoordinates.startingRow+shipSize>10),generatePotentialCoordinates=(proposedPositions,shipSize)=>{const potentialCoordinates=[];if("horizontal"===proposedPositions.alignment)for(let i=0;i<shipSize;i++)potentialCoordinates.push({x:proposedPositions.startingColumn+i,y:proposedPositions.startingRow});else for(let i=0;i<shipSize;i++)potentialCoordinates.push({x:proposedPositions.startingColumn,y:proposedPositions.startingRow+i});return potentialCoordinates},isShipSunk=(shipName,board)=>board.flat().filter((ship=>(null==ship?void 0:ship.name)===shipName)).every((ship=>(null==ship?void 0:ship.status)===_types__WEBPACK_IMPORTED_MODULE_0__.J.hit)),checkAllShipsSunk=board=>board.flat().filter((ship=>null==ship?void 0:ship.name)).every((ship=>(null==ship?void 0:ship.status)===_types__WEBPACK_IMPORTED_MODULE_0__.J.hit)),declareWinner=player=>"user"===player?(console.log("WINNER"),window.alert("You win!"),"WINNER"):(console.log("LOSER"),window.alert("You lose!"),"LOSER")},"./src/logic/placeShips.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{fn:()=>initialiseShipArray,V9:()=>placeShips});var types=__webpack_require__("./src/types.ts"),react=__webpack_require__("./node_modules/react/index.js"),GameContext=__webpack_require__("./src/GameContext.tsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const Window=props=>{const{children,title,className}=props;return(0,jsx_runtime.jsx)("div",{className:`window ${className}`,children:(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("h3",{children:title}),children]})})},components_Window=Window;Window.__docgenInfo={description:"",methods:[],displayName:"Window",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},title:{required:!0,tsType:{name:"string"},description:""},className:{required:!0,tsType:{name:"string"},description:""}}};var Board=__webpack_require__("./src/components/Board.tsx"),helpers=__webpack_require__("./src/logic/helpers.ts");const HeatValues={hit:100,miss:0,unguessed:1,sunk:-1},checkValidShipPlacement=_ref=>{let{proposedPositions,shipSize,existingPositions}=_ref;if(!(0,helpers.PZ)(proposedPositions,shipSize))return!1;const potentialCoordinates=(0,helpers.Pm)(proposedPositions,shipSize);let valid=!0;return potentialCoordinates.forEach((_ref2=>{let{x,y}=_ref2;existingPositions[y][x]&&(valid=!1)})),valid};const isHeatable=cell=>cell!==HeatValues.hit&&cell!==HeatValues.miss,isAdjacentToHit=(existingBoard,x,y)=>{var _existingBoard$x,_existingBoard$x2,_existingBoard$y,_existingBoard$y2;return y>0&&(null===(_existingBoard$x=existingBoard[y-1][x])||void 0===_existingBoard$x?void 0:_existingBoard$x.status)===types.J.hit&&!(0,helpers.Q7)(existingBoard[y-1][x].name,existingBoard)||(y<existingBoard.length-1&&(null===(_existingBoard$x2=existingBoard[y+1][x])||void 0===_existingBoard$x2?void 0:_existingBoard$x2.status)===types.J.hit&&!(0,helpers.Q7)(existingBoard[y+1][x].name,existingBoard)||(x>0&&(null===(_existingBoard$y=existingBoard[y][x-1])||void 0===_existingBoard$y?void 0:_existingBoard$y.status)===types.J.hit&&!(0,helpers.Q7)(existingBoard[y][x-1].name,existingBoard)||x<existingBoard[y].length-1&&(null===(_existingBoard$y2=existingBoard[y][x+1])||void 0===_existingBoard$y2?void 0:_existingBoard$y2.status)===types.J.hit&&!(0,helpers.Q7)(existingBoard[y][x+1].name,existingBoard)))},calculateHeatMap=(existingBoard,aiLevel)=>{let heatMap=function initialiseHeatMapArray(){let array=[];for(let i=0;i<10;i++)array[i]=new Array(10).fill(HeatValues.unguessed);return array}();const{missCoolnessRadius}=(aiLevel=>{let missCoolnessRadius;switch(aiLevel){case"easy":default:missCoolnessRadius=0;break;case"medium":missCoolnessRadius=1;break;case"hard":missCoolnessRadius=2}return{missCoolnessRadius}})(aiLevel);for(let i=0;i<100;i++){var _HeatValues,_existingBoard$y$x2;let y=Math.floor(i/10),x=i%10;heatMap[y][x]=null!==(_HeatValues=HeatValues[null===(_existingBoard$y$x2=existingBoard[y][x])||void 0===_existingBoard$y$x2?void 0:_existingBoard$y$x2.status])&&void 0!==_HeatValues?_HeatValues:HeatValues.unguessed}for(let i=0;i<100;i++){let y=Math.floor(i/10),x=i%10;const thisCell=existingBoard[y][x];if((null==thisCell?void 0:thisCell.status)===types.J.hit&&null!=thisCell&&thisCell.name&&!(0,helpers.Q7)(thisCell.name,existingBoard)){var _existingBoard$y3,_existingBoard$y4,_existingBoard$x3,_existingBoard$x4;if(y>0&&isHeatable(heatMap[y-1][x])&&(heatMap[y-1][x]*=3,y>1&&isHeatable(heatMap[y-2][x])&&(heatMap[y-2][x]*=1.5)),y<existingBoard.length-1&&isHeatable(heatMap[y+1][x])&&(heatMap[y+1][x]*=3,y<existingBoard.length-2&&isHeatable(heatMap[y+2][x])&&(heatMap[y+2][x]*=1.5)),x<existingBoard[y].length-1&&isHeatable(heatMap[y][x+1])&&(heatMap[y][x+1]*=3,x<existingBoard[y].length-2&&isHeatable(heatMap[y][x+2])&&(heatMap[y][x+2]*=1.5)),x>0&&isHeatable(heatMap[y][x-1])&&(heatMap[y][x-1]*=3,x>1&&isHeatable(heatMap[y][x-2])&&(heatMap[y][x-2]*=1.5)),x>0&&(null===(_existingBoard$y3=existingBoard[y][x-1])||void 0===_existingBoard$y3?void 0:_existingBoard$y3.status)===types.J.hit)for(let i=x;i>=0;i--){var _existingBoard$y$i3;if((null===(_existingBoard$y$i3=existingBoard[y][i])||void 0===_existingBoard$y$i3?void 0:_existingBoard$y$i3.status)===types.J.miss)break;if(isHeatable(heatMap[y][i])){heatMap[y][i]*=1.5,i>0&&isHeatable(heatMap[y][i-1])&&(heatMap[y][i-1]*=1.5);break}}if(x<existingBoard[y].length-1&&(null===(_existingBoard$y4=existingBoard[y][x+1])||void 0===_existingBoard$y4?void 0:_existingBoard$y4.status)===types.J.hit)for(let i=x;i<existingBoard[y].length;i++){var _existingBoard$y$i4;if((null===(_existingBoard$y$i4=existingBoard[y][i])||void 0===_existingBoard$y$i4?void 0:_existingBoard$y$i4.status)===types.J.miss)break;if(isHeatable(heatMap[y][i])){heatMap[y][i]*=1.5,i<existingBoard[y].length-1&&isHeatable(heatMap[y][i+1])&&(heatMap[y][i+1]*=1.5);break}}if(y>0&&(null===(_existingBoard$x3=existingBoard[y-1][x])||void 0===_existingBoard$x3?void 0:_existingBoard$x3.status)===types.J.hit)for(let i=y;i>=0;i--){var _existingBoard$i$x3;if((null===(_existingBoard$i$x3=existingBoard[i][x])||void 0===_existingBoard$i$x3?void 0:_existingBoard$i$x3.status)===types.J.miss)break;if(isHeatable(heatMap[i][x])){heatMap[i][x]*=1.5,i>0&&isHeatable(heatMap[i-1][x])&&(heatMap[i-1][x]*=1.5);break}}if(y<existingBoard.length-1&&(null===(_existingBoard$x4=existingBoard[y+1][x])||void 0===_existingBoard$x4?void 0:_existingBoard$x4.status)===types.J.hit)for(let i=y;i<existingBoard.length;i++){var _existingBoard$i$x4;if((null===(_existingBoard$i$x4=existingBoard[i][x])||void 0===_existingBoard$i$x4?void 0:_existingBoard$i$x4.status)===types.J.miss)break;if(isHeatable(heatMap[i][x])){heatMap[i][x]*=1.5,i<existingBoard.length-1&&isHeatable(heatMap[i+1][x])&&(heatMap[i+1][x]*=1.5);break}}}}missCoolnessRadius>0&&(heatMap=((heatMap,existingBoard,missCoolnessRadius)=>{const newHeatMap=heatMap.map((row=>[...row]));for(let i=0;i<100;i++){let y=Math.floor(i/10),x=i%10;var _existingBoard$y$x;if(missCoolnessRadius>0&&(null===(_existingBoard$y$x=existingBoard[y][x])||void 0===_existingBoard$y$x?void 0:_existingBoard$y$x.status)===types.J.miss){if(y>0&&isHeatable(heatMap[y-1][x])&&!isAdjacentToHit(existingBoard,x,y-1)&&(newHeatMap[y-1][x]*=.6,y>1&&isHeatable(heatMap[y-2][x])&&!isAdjacentToHit(existingBoard,x,y-2)&&(newHeatMap[y-2][x]*=.7)),y<existingBoard.length-1&&isHeatable(heatMap[y+1][x])&&!isAdjacentToHit(existingBoard,x,y+1)&&(newHeatMap[y+1][x]*=.6,y<existingBoard.length-2&&isHeatable(heatMap[y+2][x])&&!isAdjacentToHit(existingBoard,x,y+2)&&(newHeatMap[y+2][x]*=.7)),x<existingBoard[y].length-1&&isHeatable(heatMap[y][x+1])&&!isAdjacentToHit(existingBoard,x+1,y)&&(newHeatMap[y][x+1]*=.6,x<existingBoard[y].length-2&&isHeatable(heatMap[y][x+2])&&!isAdjacentToHit(existingBoard,x+2,y)&&(newHeatMap[y][x+2]*=.7)),x>0&&isHeatable(heatMap[y][x-1])&&!isAdjacentToHit(existingBoard,x-1,y)&&(newHeatMap[y][x-1]*=.6,x>1&&isHeatable(heatMap[y][x-2])&&!isAdjacentToHit(existingBoard,x-2,y)&&(newHeatMap[y][x-2]*=.7)),x>0&&isHeatable(heatMap[y][x-1]))for(let i=x;i>=0;i--){var _existingBoard$y$i;if((null===(_existingBoard$y$i=existingBoard[y][i])||void 0===_existingBoard$y$i?void 0:_existingBoard$y$i.status)===types.J.hit)break;if(isHeatable(heatMap[y][i])){newHeatMap[y][i]*=.6,i>0&&isHeatable(heatMap[y][i-1])&&!isAdjacentToHit(existingBoard,i-1,y)&&(newHeatMap[y][i-1]*=.7),missCoolnessRadius>1&&i>1&&isHeatable(heatMap[y][i-2])&&!isAdjacentToHit(existingBoard,i-2,y)&&(newHeatMap[y][i-2]*=.8);break}}if(x<existingBoard[y].length-1&&isHeatable(heatMap[y][x+1]))for(let i=x;i<existingBoard[y].length;i++){var _existingBoard$y$i2;if((null===(_existingBoard$y$i2=existingBoard[y][i])||void 0===_existingBoard$y$i2?void 0:_existingBoard$y$i2.status)===types.J.hit)break;if(isHeatable(heatMap[y][i])){newHeatMap[y][i]*=.7,i<existingBoard[y].length-1&&isHeatable(heatMap[y][i+1])&&!isAdjacentToHit(existingBoard,i+1,y)&&(newHeatMap[y][i+1]*=.8),missCoolnessRadius>1&&i<existingBoard[y].length-2&&isHeatable(heatMap[y][i+2])&&!isAdjacentToHit(existingBoard,i+2,y)&&(newHeatMap[y][i+2]*=.8);break}}if(y>0&&isHeatable(heatMap[y-1][x]))for(let i=y;i>=0;i--){var _existingBoard$i$x;if((null===(_existingBoard$i$x=existingBoard[i][x])||void 0===_existingBoard$i$x?void 0:_existingBoard$i$x.status)===types.J.hit)break;if(isHeatable(heatMap[i][x])&&!isAdjacentToHit(existingBoard,x,i)){newHeatMap[i][x]*=.6,i>0&&isHeatable(heatMap[i-1][x])&&!isAdjacentToHit(existingBoard,x,i-1)&&(newHeatMap[i-1][x]*=.7),missCoolnessRadius>1&&i>1&&isHeatable(heatMap[i-2][x])&&!isAdjacentToHit(existingBoard,i-2,y)&&(newHeatMap[i-2][x]*=.8);break}}if(y<existingBoard.length-1&&isHeatable(heatMap[y+1][x]))for(let i=y;i<existingBoard.length;i++){var _existingBoard$i$x2;if((null===(_existingBoard$i$x2=existingBoard[i][x])||void 0===_existingBoard$i$x2?void 0:_existingBoard$i$x2.status)===types.J.hit)break;if(isHeatable(heatMap[i][x])&&!isAdjacentToHit(existingBoard,x,i)){newHeatMap[i][x]*=.6,i<existingBoard.length-1&&isHeatable(heatMap[i+1][x])&&(newHeatMap[i+1][x]*=.7),missCoolnessRadius>1&&i<existingBoard.length-2&&isHeatable(heatMap[i+2][x])&&!isAdjacentToHit(existingBoard,i+2,y)&&(newHeatMap[i+2][x]*=.8);break}}}}return newHeatMap})(heatMap,existingBoard,missCoolnessRadius)),heatMap=((heatMap,existingBoard)=>{const newHeatMap=heatMap.map((row=>[...row]));for(let i=0;i<heatMap[0].length;i++){var _existingBoard$0$i,_existingBoard$i,_existingBoard$i$,_existingBoard$i2;(null===(_existingBoard$0$i=existingBoard[0][i])||void 0===_existingBoard$0$i?void 0:_existingBoard$0$i.status)===types.J.hit||isAdjacentToHit(existingBoard,i,0)||(newHeatMap[0][i]*=.6),(null===(_existingBoard$i=existingBoard[heatMap.length-1][i])||void 0===_existingBoard$i?void 0:_existingBoard$i.status)===types.J.hit||isAdjacentToHit(existingBoard,i,heatMap.length-1)||(newHeatMap[heatMap.length-1][i]*=.6),(null===(_existingBoard$i$=existingBoard[i][0])||void 0===_existingBoard$i$?void 0:_existingBoard$i$.status)===types.J.hit||isAdjacentToHit(existingBoard,i,0)||(newHeatMap[i][0]*=.6),(null===(_existingBoard$i2=existingBoard[i][heatMap[i].length-1])||void 0===_existingBoard$i2?void 0:_existingBoard$i2.status)===types.J.hit||isAdjacentToHit(existingBoard,i,heatMap[i].length-1)||(newHeatMap[i][heatMap[i].length-1]*=.6)}return newHeatMap})(heatMap,existingBoard),heatMap=((heatMap,existingBoard)=>{const newHeatMap=heatMap.map((row=>[...row]));for(let i=0;i<100;i++){let y=Math.floor(i/10),x=i%10;existingBoard[y][x]&&(0,helpers.Q7)(existingBoard[y][x].name,existingBoard)&&newHeatMap[y][x]!==HeatValues.hit&&(newHeatMap[y][x]*=.6)}return newHeatMap})(heatMap,existingBoard);for(let i=0;i<100;i++){var _existingBoard$y$x3,_existingBoard$y$x4,_existingBoard$y$x5;let y=Math.floor(i/10),x=i%10,heatMultiplier=0;(null===(_existingBoard$y$x3=existingBoard[y][x])||void 0===_existingBoard$y$x3?void 0:_existingBoard$y$x3.status)!==types.J.hit&&(null===(_existingBoard$y$x4=existingBoard[y][x])||void 0===_existingBoard$y$x4?void 0:_existingBoard$y$x4.status)!==types.J.miss&&shipTypes.forEach((ship=>{(0,helpers.Q7)(ship.name,existingBoard)||(checkValidShipPlacement({proposedPositions:{startingRow:y,startingColumn:x,alignment:"horizontal"},shipSize:ship.size,existingPositions:existingBoard})&&(heatMultiplier+=1),checkValidShipPlacement({proposedPositions:{startingRow:y,startingColumn:x,alignment:"vertical"},shipSize:ship.size,existingPositions:existingBoard})&&(heatMultiplier+=1),x-ship.size>=0&&checkValidShipPlacement({proposedPositions:{startingRow:y,startingColumn:x-ship.size,alignment:"horizontal"},shipSize:ship.size,existingPositions:existingBoard})&&(heatMultiplier+=1),y-ship.size>=0&&checkValidShipPlacement({proposedPositions:{startingRow:y-ship.size,startingColumn:x,alignment:"vertical"},shipSize:ship.size,existingPositions:existingBoard})&&(heatMultiplier+=1))})),heatMap[y][x]+=heatMultiplier/(4*shipTypes.length),null!==(_existingBoard$y$x5=existingBoard[y][x])&&void 0!==_existingBoard$y$x5&&_existingBoard$y$x5.name&&(0,helpers.Q7)(existingBoard[y][x].name,existingBoard)&&(heatMap[y][x]=HeatValues.sunk)}return heatMap},letters=["A","B","C","D","E","F","G","H","I","J"];var UserGuessBoard=__webpack_require__("./src/components/UserGuessBoard.tsx");const Log=()=>{const{log}=(0,react.useContext)(GameContext.A);return(0,jsx_runtime.jsx)("ul",{className:"game-log",children:log.map(((item,index)=>(0,jsx_runtime.jsx)("li",{className:"log-entry",children:item},index)))})};Log.__docgenInfo={description:"",methods:[],displayName:"Log"};const shipTypes=[{name:"carrier",size:5},{name:"battleship",size:4},{name:"cruiser",size:3},{name:"submarine",size:3},{name:"destroyer",size:2}],GameBoards=()=>{const{userShips,computerShips,playerTurn,setPlayerTurn,gameEnded,addToLog,aiLevel}=(0,react.useContext)(GameContext.A),makeComputerGuess=(()=>{const{userShips,setUserShips,addToLog,aiLevel}=(0,react.useContext)(GameContext.A);return(0,react.useCallback)((()=>{const flatHeatMap=calculateHeatMap(userShips,aiLevel).flat(),sortedValues=[...flatHeatMap].sort(((a,b)=>b-a)),top2Values=[...new Set(sortedValues)].slice(0,2);let maxValue=-1,maxValueIndex=0;flatHeatMap.forEach(((value,index)=>{value!==HeatValues.hit&&value>maxValue&&(maxValue=value,maxValueIndex=index)}));const maxValueIndices=flatHeatMap.reduce(((indices,value,index)=>(top2Values.includes(value)&&indices.push(index),indices)),[]),randomIndex=maxValueIndices[Math.floor(Math.random()*maxValueIndices.length)],y=Math.floor(randomIndex/10),x=randomIndex%10,cell=userShips[y][x];if((null==cell?void 0:cell.status)===types.J.unguessed||!cell){const newUserShips=[...userShips.map((row=>[...row]))],status=null!=cell&&cell.name?types.J.hit:types.J.miss;newUserShips[y][x]={name:(null==cell?void 0:cell.name)||null,status},setUserShips(newUserShips),addToLog(`Computer guessed ${letters[y]}${x+1}, ${status}`),(0,helpers.Q7)(null==cell?void 0:cell.name,newUserShips)&&(addToLog(`Computer sunk ${null==cell?void 0:cell.name}`),(0,helpers.U4)(newUserShips)&&addToLog((0,helpers.oE)("computer")))}}),[userShips,setUserShips,addToLog])})();return(0,react.useEffect)((()=>{gameEnded||addToLog(`${playerTurn} turn`)}),[playerTurn]),(0,react.useEffect)((()=>{"computer"!==playerTurn||gameEnded||(makeComputerGuess(),setPlayerTurn("user"))}),[playerTurn]),(0,jsx_runtime.jsxs)("div",{className:"game-container",children:[(0,jsx_runtime.jsx)("div",{className:"player-guess-board",children:(0,jsx_runtime.jsx)("div",{className:"player-guess-board-inner",children:(0,jsx_runtime.jsx)(UserGuessBoard.A,{})})}),(0,jsx_runtime.jsx)(components_Window,{title:"Computer avatar",className:"computer-avatar",children:(0,jsx_runtime.jsx)("div",{children:"Computer's avatar will appear here"})}),(0,jsx_runtime.jsx)(components_Window,{title:"Stats",className:"stats",children:(0,jsx_runtime.jsx)("div",{children:"Stats will appear here"})}),(0,jsx_runtime.jsx)(components_Window,{title:"Player fleet",className:"player-fleet",children:(0,jsx_runtime.jsx)(Board.A,{positions:userShips})}),(0,jsx_runtime.jsx)(components_Window,{title:"Feed",className:"feed",children:(0,jsx_runtime.jsx)(Log,{})})]})};function App(){return(0,jsx_runtime.jsx)(GameContext.S,{children:(0,jsx_runtime.jsx)(GameBoards,{})})}function initialiseShipArray(){let array=[];for(let i=0;i<10;i++)array[i]=new Array(10).fill(null);return array}App.__docgenInfo={description:"",methods:[],displayName:"App"};const generateRandomPosition=function(ship){let startingRow,startingColumn,alignment=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.random()>.5?"horizontal":"vertical";return"horizontal"===alignment?(startingRow=Math.floor(10*Math.random()),startingColumn=Math.floor(Math.random()*(11-ship.size))):(startingRow=Math.floor(Math.random()*(11-ship.size)),startingColumn=Math.floor(10*Math.random())),{startingRow,startingColumn,alignment}},checkValidShipState=_ref=>{let{proposedPositions,shipSize,existingPositions,adjacentShipModifier=0}=_ref;if(!(0,helpers.PZ)(proposedPositions,shipSize))return!1;const potentialCoordinates=(0,helpers.Pm)(proposedPositions,shipSize);let valid=!0;const adjacentShipsAllowable=Math.random()+adjacentShipModifier>=1;return potentialCoordinates.forEach((_ref2=>{let{x,y}=_ref2;adjacentShipsAllowable||(existingPositions[Math.max(0,y-1)][x]&&(valid=!1),existingPositions[Math.min(9,y+1)][x]&&(valid=!1),existingPositions[y][Math.max(0,x-1)]&&(valid=!1),existingPositions[y][Math.min(9,x+1)]&&(valid=!1))})),valid},placeShips=()=>{const positions=initialiseShipArray();return shipTypes.forEach((ship=>{let validShipState=!1;for(;!validShipState;){let proposedPositions=generateRandomPosition(ship);if(validShipState=checkValidShipState({proposedPositions,shipSize:ship.size,existingPositions:positions}),validShipState)if("horizontal"===proposedPositions.alignment)for(let i=proposedPositions.startingColumn;i<proposedPositions.startingColumn+ship.size;i++)positions[proposedPositions.startingRow][i]={name:ship.name,status:types.J.unguessed};else for(let i=proposedPositions.startingRow;i<proposedPositions.startingRow+ship.size;i++)positions[i][proposedPositions.startingColumn]={name:ship.name,status:types.J.unguessed}}})),positions}},"./src/types.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{J:()=>CellStates});let CellStates=function(CellStates){return CellStates.hit="hit",CellStates.miss="miss",CellStates.unguessed="unguessed",CellStates}({})},"./src/stories/Board.stories.css":()=>{},"./node_modules/react/cjs/react-jsx-runtime.production.min.js":(__unused_webpack_module,exports,__webpack_require__)=>{var f=__webpack_require__("./node_modules/react/index.js"),k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};function q(c,a,g){var b,d={},e=null,h=null;for(b in void 0!==g&&(e=""+g),void 0!==a.key&&(e=""+a.key),void 0!==a.ref&&(h=a.ref),a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l,exports.jsx=q,exports.jsxs=q},"./node_modules/react/jsx-runtime.js":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__("./node_modules/react/cjs/react-jsx-runtime.production.min.js")}}]);